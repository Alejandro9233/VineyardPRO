<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VINEYARD PRO</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,700&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
</head>
<style>
    .sideBar{
        width: 290px;
        height: 700px;
        flex-shrink: 0;
        border-radius: 30px;
        background: #FFF;
        box-shadow: 14px 17px 40px 4px rgba(112, 144, 176, 0.08);
        display: flex;
        justify-content: center;
        margin-left: 2%;
        margin-top: 1%;
    }

    .homeLogo{ 
        margin-top: 10%;
        display: flex;
        justify-content: center;  
        width: 100%;
        height: 26px;
    }
    .logo{
        color: #2B3674;
        font-family: 'Poppins', sans-serif;
        font-size: 26px;
        font-weight: 700;
        line-height: 100%;
    }
    .dashBoard{
        margin-top: 1%;
        margin-left: 3%;
        width: 1000px;
        height: 700px;
    }
    .indexSubTitle{
        width: 207.419px;
        height: 28.141px;
        color: #707EAE;
        font-family: DM Sans;
        font-size: 14px;
        font-style: normal;
        font-weight: 500;
        line-height: 24px; /* 171.429% */
    }
    .indexTitle{
        margin-top: -2%;
        width: 351.016px;
        height: 49.246px;
        flex-shrink: 0;
        color: #2B3674;
        font-family: DM Sans;
        font-size: 34px;
        font-style: normal;
        font-weight: 700;
        line-height: 42px; /* 123.529% */
        letter-spacing: -0.68px;
    }
    .space{
        border: solid 1px red;
    }
    .imgSetting{
        border-radius: 15px;
        height: 300px;
        width: 500px;
        box-shadow: 14px 17px 40px 4px rgba(112, 144, 176, 0.08);
    }
    .featureLayout{
        height: 300px;
        width: 500px;
        border-radius: 30px;
        background: #FFF;
        box-shadow: 14px 17px 40px 4px rgba(112, 144, 176, 0.08);
    }
    .featureTitle{
        margin-top: 2%;
        color: #1B2559;
        font-family: DM Sans;
        font-size: 18px;
        font-style: normal;
        font-weight: 700;
        line-height: 30px; /* 166.667% */
    }
    .optionHectare{
        margin-top: 4px;
        margin-left: -35px;
        color: #A3AED0;
        font-family: DM Sans;
        font-size: 14px;
        font-style: normal;
        font-weight: 500;
        line-height: 24px; /* 171.429% */
        letter-spacing: -0.28px;
    }
    .buttonLayout{
        width: 100%; 
        height: 70%;
        display: grid;
        place-items: center;
    }
    .buttonCircle{
        width: 90px;
        height: 90px;
        border-radius: 90%;
        fill: #FFF;
        box-shadow: 0px 18px 40px rgba(112, 144, 176, 0.12);
        display: grid;
        place-items: center;
    }
    .buttonCircleWater{
        width: 90px;
        height: 90px;
        border-radius: 90%;
        fill: #FFF;
        box-shadow: 0px 18px 40px rgba(112, 144, 176, 0.12);
        display: grid;
        place-items: center;
    }
    .buttonCircleLight{
        width: 90px;
        height: 90px;
        border-radius: 90%;
        fill: #FFF;
        box-shadow: 0px 18px 40px rgba(112, 144, 176, 0.12);
        display: grid;
        place-items: center;
    }
    .tempBar{
        display: flex;
        margin-top: -22%;
        width: 80%;
        height: 80%;
        align-items: flex-start;
        gap: 303.123px;
        border-radius: 13px;
        background: #FFF;
        box-shadow: 0px 18px 40px 0px rgba(112, 144, 176, 0.12);
    }
    .tempLocal{
        border: solid 1px red;
        display: flex;
        align-items: flex-start;
        border-radius: 13px;
        background: #FFF;
        box-shadow: 0px 18px 40px 0px rgba(112, 144, 176, 0.12);
    }

</style>
<body class="container-fluid">
    <div class="row">
        <div class="col-md-auto sideBar">
            <div class="row">
                <div class="homeLogo border-bottom">
                    <p class="logo">VINEYARD PRO</p>
                </div>
                <div>
                    {% for user in users %}
                    <div style="text-align: center; font-family: 'Poppins', sans-serif; color: #707EAE; margin-top: -300px;">
                        <p> HI, {{ user['name'] }}!! </p>
                        <p> WELCOME </p>
                    </div>
                    {% endfor %}
                </div>
            </div> 
        </div>
        <div class="col dashBoard">
            <div class="row">
                <div class="col">
                    <p class="indexSubTitle">
                        Dashboards / Smart Vineyard
                    </p>
                    <p class="indexTitle">
                        {{ vineyards[0].name }}
                    </p>
                </div>
                <div class="col">
                    <div style="background: #FFF; box-shadow: 0px 18px 40px 0px rgba(112, 144, 176, 0.12); margin-top: 3%; margin-left: 60%; width: 30%; height: auto; border-radius: 13px;" >
                        <div class="col" style="height: 100%; display: grid; place-items: center; color: #707EAE; font-family: DM Sans; font-size: 14px;">
                            MONTERREY
                        </div>
                        <div class="col" style="height: 100%; display: grid; place-items: center; color: #2B3674; font-family: DM Sans; font-size: 24px;">
                            {{temperature+2}}째C
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col" style="background: ightgray 50% ;">
                    <img class="imgSetting" src="{{ vineyards[0].imgURL }}" alt="vinedo">
                </div>
                <div class="col">
                    <div class="featureLayout">
                        <p class="featureTitle">
                            Temperature Indicator
                        </p>
                        <div class="row" style="width: 40%; margin-top: -20px;">
                            <div class="col">
                                <img style="width: 30px; height: auto;" src="https://icones.pro/wp-content/uploads/2021/02/icone-de-broche-de-localisation-noire.png" alt="ubi">
                            </div> 
                            <div class="col">
                                <p class="optionHectare">Hectare 1</p>
                            </div>
                            <div class="col">
                                <img style="width: 30px; height: auto;margin-left: -30px; margin-top: 1px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/Ic_arrow_drop_down_48px.svg/1200px-Ic_arrow_drop_down_48px.svg.png" alt="ubi">
                            </div>     
                        </div>
                        <div class="buttonLayout">
                            <div class="buttonCircle">
                                <p class="indexTitle" id="textTemp" type="number" style="margin-top: 6%; margin-left: 7%;"></p>
                            </div>
                            <div class="tempBar">
                                <div class="col" style="height: 100%; display: grid; place-items: center;">18째C</div>
                                <div class="col" style="height: 100%; display: grid; place-items: center;">38째C</div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="featureLayout">
                        <p class="featureTitle">
                            Sprinkler Controller
                        </p>
                        <div class="row" style="width: 40%; margin-top: -20px;">
                            <div class="col">
                                <img style="width: 30px; height: auto;" src="https://icones.pro/wp-content/uploads/2021/02/icone-de-broche-de-localisation-noire.png" alt="ubi">
                            </div> 
                            <div class="col">
                                <p class="optionHectare">Hectare 1</p>
                            </div>
                            <div class="col">
                                <img style="width: 30px; height: auto;margin-left: -30px; margin-top: 1px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/Ic_arrow_drop_down_48px.svg/1200px-Ic_arrow_drop_down_48px.svg.png" alt="ubi">
                            </div>     
                        </div>
                        <div class="buttonLayout">
                            <a href="#" class="buttonCircleWater">
                                <img style="width: 50px; height: auto;" src="https://icon-library.com/images/water-drop-png-icon/water-drop-png-icon-21.jpg" alt="light bulb">
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="featureLayout">
                        <p class="featureTitle">
                            Ceiling Controller
                        </p>
                        <div class="row" style="width: 40%; margin-top: -20px;">
                            <div class="col">
                                <img style="width: 30px; height: auto;" src="https://icones.pro/wp-content/uploads/2021/02/icone-de-broche-de-localisation-noire.png" alt="ubi">
                            </div> 
                            <div class="col">
                                <p class="optionHectare">Hectare 1</p>
                            </div>
                            <div class="col">
                                <img style="width: 30px; height: auto;margin-left: -30px; margin-top: 1px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/Ic_arrow_drop_down_48px.svg/1200px-Ic_arrow_drop_down_48px.svg.png" alt="ubi">
                            </div>     
                        </div>
                        <div class="buttonLayout">
                            <a href="#" class="buttonCircleLight">
                                <img style="width: 50px; height: auto;" src="https://cdn-icons-png.flaticon.com/512/3054/3054429.png" alt="light bulb">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </div> 
</body>
<script type="module">

// Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyCPTiXROt_IMWHbliq61Kjjj8kTcdfh28E",
    authDomain: "ejemplofirebase-23e33.firebaseapp.com",
    databaseURL: "https://ejemplofirebase-23e33-default-rtdb.firebaseio.com",
    projectId: "ejemplofirebase-23e33",
    storageBucket: "ejemplofirebase-23e33.appspot.com",
    messagingSenderId: "1093936787640",
    appId: "1:1093936787640:web:d8485aed929747ded0044d",
    measurementId: "G-2QS0Q63DVF"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);

  import {getDatabase, ref, get, set, child, update, remove}
  from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js"

  const db = getDatabase()
  console.log(db);

  let textTemp = document.getElementById("textTemp");
  let luz = 0;
  let sprinklerButton;
  let ceilingButton;

  function FindData() {
            const dbref = ref(db);

            get(child(dbref, "Vineyard/01"))
            .then((snapshot)=>{
                if(snapshot.exists()){
                    textTemp.innerHTML = snapshot.val().temperatura + "째";
                    luz = snapshot.val().luz;
                    sprinklerButton = snapshot.val().botonBomba;
                    ceilingButton = snapshot.val().botonLuz;
                } else {
                    alert("No temperature data found");
                }
                if (sprinklerButton) {
                    buttonWater.style.backgroundColor = "#707EAE";
                    buttonWater.style.transform = "scale(1.1)";
                } else {
                    buttonWater.style.backgroundColor = "";
                    buttonWater.style.transform = "";
                }
                if (ceilingButton) {
                    buttonLight.style.backgroundColor = '#707EAE';
                    buttonLight.style.transform = 'scale(1.1)';
                } else {
                    buttonLight.style.backgroundColor = '';
                    buttonLight.style.transform = '';
                }
            })
            .catch((error)=>{
                alert(error)
            })
        }

    function UpdateDataSprinkler(){
        update(ref(db, "Vineyard/01"),{
            botonBomba: !sprinklerButton,
        })
        .catch((error)=>{
            alert(error);
        });
    }

    function UpdateDataCeiing(){
        update(ref(db, "Vineyard/01"),{
            botonLuz: !ceilingButton,
        })
        .catch((error)=>{
            alert(error);
        });
    }
    
    setInterval(FindData, 2000);
    setInterval(() => {
        console.log(luz, sprinklerButton, ceilingButton);
    }, 1000);

const buttonWater = document.querySelector('.buttonCircleWater');

const buttonLight = document.querySelector('.buttonCircleLight');

buttonWater.addEventListener('click', function() {
  if (sprinklerButton) {
    // Remove the effects
    buttonWater.style.backgroundColor = '';
    buttonWater.style.transform = '';
  } else {
    // Apply the effects
    buttonWater.style.backgroundColor = '#707EAE';
    buttonWater.style.transform = 'scale(1.1)';
  }

  UpdateDataSprinkler();
});

buttonLight.addEventListener('click', function() {
  if (ceilingButton) {
    // Remove the effects
    buttonLight.style.backgroundColor = '';
    buttonLight.style.transform = '';
  } else {
    // Apply the effects
    buttonLight.style.backgroundColor = '#707EAE';
    buttonLight.style.transform = 'scale(1.1)';
  }

  UpdateDataCeiing();
});

</script>
</html>